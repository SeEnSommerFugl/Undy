<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- =============================================== -->
    <!--  Shared text styles for multi-column comboboxes -->
    <!-- =============================================== -->

    <!-- Base style for all data cells -->
    <Style x:Key="MultiColumnCellText" TargetType="TextBlock">
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
    </Style>

    <!-- Header text style -->
    <Style x:Key="MultiColumnHeaderText" TargetType="TextBlock">
        <Setter Property="FontWeight" Value="Bold" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
    </Style>

    <!-- Stock text style (based on cell style) -->
    <Style x:Key="MultiColumnStockText" TargetType="TextBlock" BasedOn="{StaticResource MultiColumnCellText}">
        <Setter Property="Foreground" Value="Black" />
        <Style.Triggers>
            <!-- Highlight when out of stock -->
            <DataTrigger Binding="{Binding NumberInStock}" Value="0">
                <Setter Property="Foreground" Value="Red" />
                <Setter Property="FontWeight" Value="Bold" />
            </DataTrigger>
        </Style.Triggers>
    </Style>



    <!-- =============================================== -->
    <!--  Product row template (multi-column)            -->
    <!-- =============================================== -->
    <DataTemplate x:Key="ProductRowTemplate">
        <!-- No margin here – spacing is handled by ComboBoxItem.Padding
             and SelectedContent margin -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <!-- Product -->
                <ColumnDefinition Width="80" />
                <!-- Colour -->
                <ColumnDefinition Width="80" />
                <!-- Size -->
                <ColumnDefinition Width="90" />
                <!-- Price -->
                <ColumnDefinition Width="70" />
                <!-- Stock -->
            </Grid.ColumnDefinitions>

            <!-- Product Name -->
            <TextBlock Grid.Column="0"
                       Text="{Binding ProductName}"
                       Style="{StaticResource MultiColumnCellText}" />

            <!-- Colour -->
            <TextBlock Grid.Column="1"
                       Text="{Binding Colour}"
                       Style="{StaticResource MultiColumnCellText}" />

            <!-- Size -->
            <TextBlock Grid.Column="2"
                       Text="{Binding Size}"
                       Style="{StaticResource MultiColumnCellText}" />

            <!-- Price -->
            <TextBlock Grid.Column="3"
                       Text="{Binding Price, StringFormat='{}{0:C}'}"
                       Style="{StaticResource MultiColumnCellText}" />

            <!-- Stock -->
            <TextBlock Grid.Column="4"
                       Text="{Binding NumberInStock}"
                       Style="{StaticResource MultiColumnStockText}" />
        </Grid>
    </DataTemplate>



    <!-- =============================================== -->
    <!--  Customer row template (multi-column)           -->
    <!--  Columns: Name | Phone | Address | Postal | City-->
    <!-- =============================================== -->
    <DataTemplate x:Key="CustomerRowTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <!-- Name -->
                <ColumnDefinition Width="110" />
                <!-- Phone -->
                <ColumnDefinition Width="180" />
                <!-- Address -->
                <ColumnDefinition Width="70" />
                <!-- Postal -->
                <ColumnDefinition Width="120" />
                <!-- City -->
            </Grid.ColumnDefinitions>

            <!-- Name = FirstName + LastName -->
            <TextBlock Grid.Column="0"
                       Style="{StaticResource MultiColumnCellText}">
                <TextBlock.Text>
                    <MultiBinding StringFormat="{}{0} {1}">
                        <Binding Path="FirstName" />
                        <Binding Path="LastName" />
                    </MultiBinding>
                </TextBlock.Text>
            </TextBlock>

            <!-- Phone -->
            <TextBlock Grid.Column="1"
                       Text="{Binding PhoneNumber}"
                       Style="{StaticResource MultiColumnCellText}" />

            <!-- Address -->
            <TextBlock Grid.Column="2"
                       Text="{Binding Address}"
                       Style="{StaticResource MultiColumnCellText}" />

            <!-- Postal code -->
            <TextBlock Grid.Column="3"
                       Text="{Binding PostalCode}"
                       Style="{StaticResource MultiColumnCellText}" />

            <!-- City -->
            <TextBlock Grid.Column="4"
                       Text="{Binding City}"
                       Style="{StaticResource MultiColumnCellText}" />
        </Grid>
    </DataTemplate>



    <!-- =============================================== -->
    <!--  Base multi-column ComboBox template            -->
    <!--  Reused by all specific multi-column combos     -->
    <!-- =============================================== -->
    <Style x:Key="BaseMultiColumnComboBoxStyle" TargetType="ComboBox">
        <!-- General ComboBox settings -->
        <Setter Property="Height" Value="30" />
        <Setter Property="IsEditable" Value="False" />
        <Setter Property="HorizontalContentAlignment" Value="Stretch" />

        <!-- Container style for each dropdown item -->
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="ComboBoxItem">
                    <!-- Vertical spacing for rows (also used visually for selected row) -->
                    <Setter Property="Padding" Value="0,2" />
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Style.Triggers>
                        <!-- Hover style -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#FFE5F1FF" />
                        </Trigger>
                        <!-- Selected style -->
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#FFD6EBFF" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Setter.Value>
        </Setter>

        <!-- Shared ComboBox Template (no arrow) -->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBox">
                    <Grid>
                        <!-- Visible combo field -->
                        <Border x:Name="ContentBorder"
                                Background="White"
                                BorderBrush="Gray"
                                BorderThickness="1"
                                CornerRadius="0">

                            <!-- Entire field is clickable -->
                            <ToggleButton x:Name="DropDownToggle"
                                          Background="Transparent"
                                          BorderThickness="0"
                                          Focusable="False"
                                          HorizontalContentAlignment="Stretch"
                                          IsChecked="{Binding IsDropDownOpen,
                                                              Mode=TwoWay,
                                                              RelativeSource={RelativeSource TemplatedParent}}">

                                <Grid>
                                    <!-- Selected item using ItemTemplate -->
                                    <ContentPresenter x:Name="SelectedContent"
                                                      Margin="0,2"
                                                      Content="{Binding SelectedItem,
                                                                        RelativeSource={RelativeSource AncestorType=ComboBox}}"
                                                      ContentTemplate="{TemplateBinding ItemTemplate}" />

                                    <!-- Placeholder when nothing is selected -->
                                    <TextBlock x:Name="PlaceholderText"
                                               Text="{TemplateBinding Text}"
                                               Visibility="Collapsed"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Foreground="Gray" />
                                </Grid>

                            </ToggleButton>
                        </Border>

                        <!-- Popup dropdown -->
                        <Popup x:Name="Popup"
                               Placement="Bottom"
                               StaysOpen="False"
                               AllowsTransparency="True"
                               IsOpen="{TemplateBinding IsDropDownOpen}">
                            <Border Background="White"
                                    BorderBrush="Gray"
                                    BorderThickness="1"
                                    MinWidth="{Binding ActualWidth, ElementName=ContentBorder}">
                                <DockPanel>
                                    <!-- Column header (defined per-style via Tag) -->
                                    <ContentPresenter DockPanel.Dock="Top"
                                                      ContentTemplate="{TemplateBinding Tag}" />
                                    <!-- Item list -->
                                    <ScrollViewer MaxHeight="300">
                                        <ItemsPresenter />
                                    </ScrollViewer>
                                </DockPanel>
                            </Border>
                        </Popup>
                    </Grid>

                    <!-- Template triggers -->
                    <ControlTemplate.Triggers>
                        <!-- Dim the field when disabled -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="ContentBorder" Property="Opacity" Value="0.5" />
                        </Trigger>
                        <!-- No item selected -> show placeholder -->
                        <Trigger Property="SelectedItem" Value="{x:Null}">
                            <Setter TargetName="SelectedContent" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="PlaceholderText" Property="Visibility" Value="Visible" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <!-- =============================================== -->
    <!--  Product MultiColumn ComboBox style             -->
    <!-- =============================================== -->
    <Style x:Key="ProductMultiColumnComboBoxStyle"
           TargetType="ComboBox"
           BasedOn="{StaticResource BaseMultiColumnComboBoxStyle}">

        <!-- Placeholder text -->
        <Setter Property="Text" Value="Vælg produkt" />

        <!-- Use Product row template -->
        <Setter Property="ItemTemplate" Value="{StaticResource ProductRowTemplate}" />

        <!-- Header row for product combo -->
        <Setter Property="Tag">
            <Setter.Value>
                <DataTemplate>
                    <Grid Background="#EEE" Margin="0,0,0,1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="80" />
                            <ColumnDefinition Width="80" />
                            <ColumnDefinition Width="90" />
                            <ColumnDefinition Width="70" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Produkt"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                        <TextBlock Grid.Column="1" Text="Farve"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                        <TextBlock Grid.Column="2" Text="Størrelse"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                        <TextBlock Grid.Column="3" Text="Pris"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                        <TextBlock Grid.Column="4" Text="På lager"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                    </Grid>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <!-- =============================================== -->
    <!--  Customer MultiColumn ComboBox style            -->
    <!-- =============================================== -->
    <Style x:Key="CustomerMultiColumnComboBoxStyle"
           TargetType="ComboBox"
           BasedOn="{StaticResource BaseMultiColumnComboBoxStyle}">

        <!-- Placeholder text -->
        <Setter Property="Text" Value="Vælg kunde" />

        <!-- Use Customer row template -->
        <Setter Property="ItemTemplate" Value="{StaticResource CustomerRowTemplate}" />

        <!-- Header row for customer combo -->
        <Setter Property="Tag">
            <Setter.Value>
                <DataTemplate>
                    <Grid Background="#EEE" Margin="0,0,0,1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="110" />
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="70" />
                            <ColumnDefinition Width="120" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Navn"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                        <TextBlock Grid.Column="1" Text="Telefon"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                        <TextBlock Grid.Column="2" Text="Adresse"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                        <TextBlock Grid.Column="3" Text="Postnr."
                                   Style="{StaticResource MultiColumnHeaderText}" />
                        <TextBlock Grid.Column="4" Text="By"
                                   Style="{StaticResource MultiColumnHeaderText}" />
                    </Grid>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>

<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- ========= BASISSTYLE FOR ALLE DATAGRIDS ========= -->
    <Style x:Key="DataGridBase" TargetType="DataGrid">
        <Style.Resources>
            <Style TargetType="TextBlock">
                <Setter Property="TextAlignment" Value="Center"/>
                <Setter Property="HorizontalAlignment" Value="Center"/>
                <Setter Property="VerticalAlignment" Value="Center"/>
            </Style>
        </Style.Resources>

        <!-- Use DynamicResource to avoid UnsetValue when dictionaries are merged after this loads -->
        <Setter Property="Background" Value="{DynamicResource Brush.Panel}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="HeadersVisibility" Value="Column"/>
        <Setter Property="GridLinesVisibility" Value="None"/>
        <Setter Property="AutoGenerateColumns" Value="False"/>
        <Setter Property="CanUserAddRows"    Value="False"/>
        <Setter Property="CanUserDeleteRows" Value="False"/>
        <Setter Property="RowHeight" Value="44"/>
        <Setter Property="IsReadOnly" Value="True"/>
        <Setter Property="ColumnHeaderHeight" Value="42"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="FontSize" Value="20"/>
        <Setter Property="SelectionMode" Value="Single"/>
        <Setter Property="SelectionUnit" Value="FullRow"/>
        <Setter Property="AlternatingRowBackground" Value="#1C2431"/>
        <Setter Property="VirtualizingPanel.IsVirtualizing" Value="True"/>
        <Setter Property="VirtualizingPanel.ScrollUnit" Value="Pixel"/>
        <Setter Property="EnableRowVirtualization" Value="True"/>
        <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>

        <!-- Header-style (default centreret) -->
        <Setter Property="ColumnHeaderStyle">
            <Setter.Value>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                </Style>
            </Setter.Value>
        </Setter>

        <!-- Række-style (selection farve osv.) -->
        <Setter Property="RowStyle">
            <Setter.Value>
                <Style TargetType="DataGridRow">
                    <!-- Explicit defaults prevent transient UnsetValue states -->
                    <Setter Property="Background"  Value="Transparent"/>
                    <Setter Property="BorderBrush" Value="Transparent"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#056097"/>
                            <Setter Property="BorderBrush" Value="#056097"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Setter.Value>
        </Setter>

        <!-- Celle-style (centreret indhold, ingen kant ved fokus) -->
        <Setter Property="CellStyle">
            <Setter.Value>
                <Style TargetType="DataGridCell">
                    <Setter Property="Background"  Value="Transparent"/>
                    <Setter Property="BorderBrush" Value="Transparent"/>
                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                    <Setter Property="VerticalContentAlignment"   Value="Center"/>
                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background"  Value="Transparent"/>
                            <Setter Property="BorderBrush" Value="Transparent"/>
                        </Trigger>
                        <Trigger Property="IsKeyboardFocusWithin" Value="True">
                            <Setter Property="Background"  Value="Transparent"/>
                            <Setter Property="BorderBrush" Value="Transparent"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ========= SMART HEADER TIL DATAGRIDS ========= -->
    <Style x:Key="DataGridHeader.Smart" TargetType="DataGridColumnHeader">
        <Setter Property="Background" Value="#223044"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="10,6"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="FontSize" Value="16"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="DataGridColumnHeader">
                    <Border Background="{TemplateBinding Background}"
                            CornerRadius="12"
                            SnapsToDevicePixels="True">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="Center"
                                          Margin="{TemplateBinding Padding}"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ========= STANDARD TABELSTYLE (BRUGES SOM BASE) ========= -->
    <Style x:Key="DataGrid.Table"
           TargetType="DataGrid"
           BasedOn="{StaticResource DataGridBase}">
        <Setter Property="RowHeight" Value="36"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="ColumnHeaderHeight" Value="36"/>
        <Setter Property="FontSize" Value="16"/>
        <Setter Property="ColumnHeaderStyle" Value="{DynamicResource DataGridHeader.Smart}"/>
        <Setter Property="MaxHeight" Value="520"/>
        <Setter Property="HorizontalAlignment" Value="Center"/>
    </Style>

    <Style x:Key="DataGridCellPill" TargetType="DataGridCell">
        <Setter Property="Padding" Value="0"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text}"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="VerticalContentAlignment"   Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="DataGridCell">
                    <!-- FallbackValue prevents UnsetValue from crashing Border.Background -->
                    <Border x:Name="Pill"
                            Background="{TemplateBinding Background}"
                            CornerRadius="16"
                            Margin="2">
                        <ContentPresenter Margin="10,4"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="DataGridCellMoney"
           TargetType="DataGridCell"
           BasedOn="{StaticResource DataGridCellPill}">

        <!-- DEFAULTS: prevents UnsetValue even if triggers don't apply or resources are missing -->
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text}"/>

        <Style.Triggers>

            <DataTrigger Binding="{Binding IsPositive}" Value="True">
                <Setter Property="Background"
                        Value="{DynamicResource Amount.Positive.Bg}"/>
                <Setter Property="Foreground"
                        Value="{DynamicResource Amount.Positive.Fg}"/>
            </DataTrigger>

            <DataTrigger Binding="{Binding IsPositive}" Value="False">
                <Setter Property="Background"
                        Value="{DynamicResource Amount.Negative.Bg}"/>
                <Setter Property="Foreground"
                        Value="{DynamicResource Amount.Negative.Fg}"/>
            </DataTrigger>

        </Style.Triggers>
    </Style>

    <!-- ========== SALES ORDER CELLS ========== -->

    <!-- Læse-tilstand: viser ordrestatus som tekst -->
    <DataTemplate x:Key="CellTemplate.SalesOrderStatus">
        <TextBlock Text="{Binding OrderStatus}"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"/>
    </DataTemplate>

    <!-- Rediger-tilstand: ComboBox med statusvalg -->
    <DataTemplate x:Key="CellEditingTemplate.SalesOrderStatus">
        <ComboBox SelectedItem="{Binding OrderStatus, UpdateSourceTrigger=PropertyChanged}"
                  ItemsSource="{Binding DataContext.OrderStatusOptions,
                                        RelativeSource={RelativeSource AncestorType=DataGrid}}"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Width="150"/>
    </DataTemplate>

    <!-- REUSABLE CELL TEMPLATE -->
    <DataTemplate x:Key="CellTemplate.MoneyDifference">
        <TextBlock Text="{Binding Difference, StringFormat={}{0:N2} kr.}"
                   FontWeight="SemiBold"/>
    </DataTemplate>

    <!-- ========= SPECIFIK STYLE TIL SALES ORDER GRID ========= -->
    <Style x:Key="DataGrid.SalesOrder"
           TargetType="DataGrid"
           BasedOn="{StaticResource DataGrid.Table}">
        <Setter Property="IsReadOnly" Value="False"/>
        <Setter Property="MaxHeight" Value="1000"/>
    </Style>

</ResourceDictionary>
